# Example: Buf + protoc-gen-ts-contract

This directory shows how to generate protobuf-es types and contract interfaces using the locally built plugin.

## Prerequisites
- `pnpm install` at repo root (installs workspace deps, including `@bufbuild/buf` for this example).
- Buf CLI available via `pnpm -C example buf`.
- `packages/ts-contract-plugin` built (`pnpm -C packages/ts-contract-plugin build`), so `dist/cli.js` exists.

## How to generate
1. From repo root, run `pnpm example:gen`.
   - Builds the plugin, then runs `buf generate . --template ./buf.gen.yaml`.
2. Inspect outputs under `example/gen` (protobuf-es and ts-contract share the same tree).

## Sample output (excerpt)
- Generated by `pnpm example:gen`, shared tree `example/gen`.
- Example contract snippet (`example/gen/es/orders/v1/order_contract.ts`):

```ts
// @generated by protoc-gen-ts-contract v0.1.4 with parameter "target=ts"
// @generated from file orders/v1/order.proto (package orders.v1, edition 2023)
// option features.field_presence = EXPLICIT;
/* eslint-disable */

import type { OrderStatus } from "./order_pb";

export interface CreateOrderRequestInput {
  order: OrderInput;
}

export interface MoneyInput {
  currencyCode?: string;
  units?: bigint;
}

export interface OrderInput {
  id: string;
  status?: OrderStatus;
  items?: OrderItemInput[];
  total: MoneyInput;
}

export interface OrderItemInput {
  sku: string;
  quantity: number;
  unitPrice?: MoneyInput;
}
```

## Cleanup
- Remove generated artifacts: `pnpm example:clean` (deletes `example/gen`).

## Notes
- `buf.lock` is committed to pin protovalidate dependency.
- Generated files in `example/gen` are untracked; regenerate after plugin changes.
